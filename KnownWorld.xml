<?xml version="1.0" encoding="utf-8" ?>
<KnownWorld>

    <ReferentialFolder Path="CK-Env/CKli/Referential" />

    <GitStatusAction Title="Displays statuses of all the repositories." />
    <GitCheckoutAction Title="Checkout all repositories on a specific branch name." />
    <GitCommitAction Title="Commits all pending changes to the current branch of all the repositories." />
    <LaunchSettingsUpdateNugetExePathAction Title="Update nuget.exe path in launchSettings.json files." />
   
    <Reusable Name="CodeCakeBuilder">
        <Folder Name="CodeCakeBuilder">
            <MustExist InitialContent="InitialCodeCakeBuilder" />
            <Region Title="Removing files and folders that should not more exist.">
                <Folder Name="Properties">
                    <MustNotExist />
                </Folder>
                <File Name="App.config">
                    <MustNotExist />
                </File>
                <File Name="CoreBuild.proj">
                    <MustNotExist />
                </File>
                <File Name="Bootstrap.ps1">
                    <MustNotExist />
                </File>
                <File Name="BootstrapAndBuild.ps1">
                    <MustNotExist />
                </File>
                <File Name="packages.config">
                    <MustNotExist />
                </File>
            </Region>
            <File Name="CodeCakeBuilder.csproj">
                <MustExist InitialContent="InitialCodeCakeBuilder/CodeCakeBuilder.csproj" />
            </File>
            <File Name="RepositoryInfo.xsd">
                <MustExist Content="InitialCodeCakeBuilder/RepositoryInfo.xsd" />
            </File>
            <File Name="Program.cs">
                <MustExist Content="InitialCodeCakeBuilder/Program.cs" />
            </File>
            <File Name="Build.cs">
                <MustExist InitialContent="InitialCodeCakeBuilder/Build.cs" >
                    <FileTransform>
                        <TextReplace Text="$Solution Name$" SourceXPath="ancestor::Folder[1]" SourcePropertyName="Name" />
                    </FileTransform>
                </MustExist>
            </File>
            <File Name="Build.StandardCheckRepository.cs">
                <MustExist Content="InitialCodeCakeBuilder/Build.StandardCheckRepository.cs" />
            </File>
            <File Name="Build.StandardSolutionBuild.cs">
                <MustExist Content="InitialCodeCakeBuilder/Build.StandardSolutionBuild.cs" />
            </File>
            <File Name="Build.StandardUnitTests.cs">
                <MustExist Content="InitialCodeCakeBuilder/Build.StandardUnitTests.cs" />
            </File>
            <File Name="Build.StandardCreateNuGetPackages.cs">
                <MustExist Content="InitialCodeCakeBuilder/Build.StandardCreateNuGetPackages.cs" />
            </File>
            <File Name="Build.StandardPushNuGetPackages.cs">
                <MustExist Content="InitialCodeCakeBuilder/Build.StandardPushNuGetPackages.cs" />
            </File>
        </Folder>
    </Reusable>

    <Reusable Name="StandardFiles">
        <StandardSolution />
        <Reuse Name="CodeCakeBuilder" />
        <File Name="NuGet.config">
            <MustExist Content="SimpleFiles/NuGet.config"/>
        </File>
        <File Name="CoreBuild.proj">
            <MustNotExist/>
        </File>
        <File Name=".editorconfig">
            <MustExist Content="SimpleFiles/.editorconfig"/>
        </File>
        <Folder Name="Common">
            <MustExist />
            <File Name="SharedKey.snk">
                <MustExist Content="SimpleFiles/SharedKey.snk"/>
            </File>
        </Folder>
    </Reusable>

    <!-- Use attribute SkipRun="True" to skip running runnable items. -->    
    <Folder Name="CK-AspNet-Projects">

        <GitFolder Name="CK-AspNet">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-AspNet-Auth">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile SqlServer="2016" />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-AspNet-Tester">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

    </Folder>
    
    <Folder Name="CK-Core-Projects">

        <GitFolder Name="CK-ActivityMonitor">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Auth-Abstractions">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Core">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Monitoring">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Reflection">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Testing">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile SqlServer="2016" />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Text">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-WeakAssemblyNameResolver">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles">
                    <Remove Target="Folder[@Name='CodeCakeBuilder']/File[@Name='Build.StandardUnitTests.cs']" />
                </Reuse>
                <AppVeyorFile />
            </Branch>
        </GitFolder>

    </Folder>

    <Folder Name="CK-Database-Projects">

        <GitFolder Name="CK-CodeGen">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

     <GitFolder Name="CK-Database">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile SqlServer="2016" PushToRemoteStore="True" />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-DB">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile SqlServer="2016" PushToRemoteStore="True" />
            </Branch>
        </GitFolder>
        
        <GitFolder Name="CK-Setup">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile PushToRemoteStore="True" />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-Setup-Dependency">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CKSetupRemoteStore">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>
        
        <GitFolder Name="CK-SqlServer-Parser">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>

        <GitFolder Name="CK-SqlServer-Parser-Model">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles">
                    <Remove Target="Folder[@Name='CodeCakeBuilder']/File[@Name='Build.StandardUnitTests.cs']" />
                </Reuse>
                <AppVeyorFile />
            </Branch>
        </GitFolder>

    </Folder>

    <Folder Name="Yodii-Projects">

        <GitFolder Name="Yodii-Script">
            <Branch Name="develop">
                <MustExist />
                <Reuse Name="StandardFiles" />
                <AppVeyorFile />
            </Branch>
        </GitFolder>
        
    </Folder>

    <File Name="CK-World">
        <MustExist Content="SimpleFiles/CK-World"/>
    </File>
</KnownWorld>
